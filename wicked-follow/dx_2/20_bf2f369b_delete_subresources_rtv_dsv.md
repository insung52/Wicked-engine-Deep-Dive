# ì»¤ë°‹ #20: bf2f369b - DX12 fix: DeleteSubresources didn't handle rtvs and dsvs

## ê¸°ë³¸ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì»¤ë°‹ í•´ì‹œ | `bf2f369b` |
| ë‚ ì§œ | 2025-12-31 |
| ì‘ì„±ì | TurÃ¡nszki JÃ¡nos |
| ì¹´í…Œê³ ë¦¬ | ë²„ê·¸ìˆ˜ì • |
| ìš°ì„ ìˆœìœ„ | ë†’ìŒ |

## ë³€ê²½ íŒŒì¼ ìš”ì•½

| íŒŒì¼ | ë³€ê²½ |
|------|------|
| wiGraphicsDevice_DX12.cpp | Texture_DX12ë¥¼ Resource_DX12ë¡œ ë³‘í•© |

---

## ë°°ê²½ ì§€ì‹: Subresourceì™€ Descriptor

### Descriptor ì¢…ë¥˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DX12 Descriptor ì¢…ë¥˜                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  SRV (Shader Resource View):                                    â”‚
â”‚  - ì‰ì´ë”ì—ì„œ ë¦¬ì†ŒìŠ¤ ì½ê¸°ìš©                                     â”‚
â”‚  - í…ìŠ¤ì²˜, ë²„í¼ ëª¨ë‘ ê°€ëŠ¥                                       â”‚
â”‚                                                                 â”‚
â”‚  UAV (Unordered Access View):                                   â”‚
â”‚  - ì‰ì´ë”ì—ì„œ ë¦¬ì†ŒìŠ¤ ì½ê¸°/ì“°ê¸°ìš©                                â”‚
â”‚  - Compute shaderì—ì„œ ì£¼ë¡œ ì‚¬ìš©                                 â”‚
â”‚                                                                 â”‚
â”‚  RTV (Render Target View):                                      â”‚
â”‚  - ë Œë” íƒ€ê²Ÿìœ¼ë¡œ ì‚¬ìš© (ì“°ê¸° ì „ìš©)                               â”‚
â”‚  - í…ìŠ¤ì²˜ë§Œ ê°€ëŠ¥                                                â”‚
â”‚                                                                 â”‚
â”‚  DSV (Depth Stencil View):                                      â”‚
â”‚  - ê¹Šì´/ìŠ¤í…ì‹¤ ë²„í¼ë¡œ ì‚¬ìš©                                      â”‚
â”‚  - í…ìŠ¤ì²˜ë§Œ ê°€ëŠ¥                                                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subresource Descriptor

í…ìŠ¤ì²˜ì˜ íŠ¹ì • mip levelì´ë‚˜ array sliceì— ëŒ€í•œ View:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Texture Subresources                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Texture (4 mip levels, 2 array slices):                        â”‚
â”‚                                                                 â”‚
â”‚  Array[0]:  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”¬â”€â”                                    â”‚
â”‚             â”‚Mip0 â”‚M1 â”‚M2â”‚3â”‚                                    â”‚
â”‚             â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”´â”€â”˜                                    â”‚
â”‚                                                                 â”‚
â”‚  Array[1]:  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”¬â”€â”                                    â”‚
â”‚             â”‚Mip0 â”‚M1 â”‚M2â”‚3â”‚                                    â”‚
â”‚             â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”´â”€â”˜                                    â”‚
â”‚                                                                 â”‚
â”‚  ì „ì²´ View (srv): ëª¨ë“  mip, ëª¨ë“  array                          â”‚
â”‚  Subresource View: íŠ¹ì • mip level ë˜ëŠ” array sliceë§Œ            â”‚
â”‚                                                                 â”‚
â”‚  ì˜ˆ: subresources_srv[0] = Array[0], Mip[1]ë§Œì˜ SRV             â”‚
â”‚      subresources_rtv[0] = Array[0], Mip[0]ì˜ RTV               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë¬¸ì œ: DeleteSubresourcesê°€ RTV/DSVë¥¼ ì •ë¦¬ ì•ˆ í•¨

### ê¸°ì¡´ í´ë˜ìŠ¤ êµ¬ì¡°

```cpp
// Resource_DX12 (ë² ì´ìŠ¤ í´ë˜ìŠ¤)
struct Resource_DX12
{
    ComPtr<ID3D12Resource> resource;
    D3D12MA::Allocation* allocation = nullptr;

    SingleDescriptor srv = {};  // ì „ì²´ SRV
    SingleDescriptor uav = {};  // ì „ì²´ UAV
    std::vector<SingleDescriptor> subresources_srv;
    std::vector<SingleDescriptor> subresources_uav;

    void destroy_subresources()
    {
        srv.destroy();
        uav.destroy();
        for (auto& x : subresources_srv) x.destroy();
        for (auto& x : subresources_uav) x.destroy();
        // âš ï¸ RTV, DSVëŠ” ì—¬ê¸°ì„œ ì •ë¦¬ ì•ˆ ë¨!
    }
};

// Texture_DX12 (íŒŒìƒ í´ë˜ìŠ¤)
struct Texture_DX12 final : public Resource_DX12
{
    SingleDescriptor rtv = {};  // âš ï¸ ì—¬ê¸°ì— ìˆìŒ!
    SingleDescriptor dsv = {};  // âš ï¸ ì—¬ê¸°ì— ìˆìŒ!
    std::vector<SingleDescriptor> subresources_rtv;  // âš ï¸ ì—¬ê¸°ì— ìˆìŒ!
    std::vector<SingleDescriptor> subresources_dsv;  // âš ï¸ ì—¬ê¸°ì— ìˆìŒ!
};
```

### ë²„ê·¸ ë°œìƒ ì‹œë‚˜ë¦¬ì˜¤

```cpp
// DeleteSubresources() í˜¸ì¶œ
void GraphicsDevice_DX12::DeleteSubresources(GPUResource* resource)
{
    auto internal = to_internal(resource);
    internal->destroy_subresources();
    // â†’ Resource_DX12::destroy_subresources() í˜¸ì¶œ
    // â†’ SRV, UAVë§Œ ì •ë¦¬ë¨
    // â†’ RTV, DSVëŠ” Texture_DX12ì— ìˆì–´ì„œ ì •ë¦¬ ì•ˆ ë¨! ğŸ’¥
}
```

### ì¦ìƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Descriptor Leak                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  DeleteSubresources() í˜¸ì¶œ ì‹œ:                                  â”‚
â”‚                                                                 â”‚
â”‚  âœ… SRV descriptor í•´ì œë¨                                       â”‚
â”‚  âœ… UAV descriptor í•´ì œë¨                                       â”‚
â”‚  âŒ RTV descriptor í•´ì œ ì•ˆ ë¨ â†’ Leak!                          â”‚
â”‚  âŒ DSV descriptor í•´ì œ ì•ˆ ë¨ â†’ Leak!                          â”‚
â”‚                                                                 â”‚
â”‚  ì¥ê¸° ì‹¤í–‰ ì‹œ:                                                  â”‚
â”‚  - Descriptor heap ê³ ê°ˆ                                         â”‚
â”‚  - ìƒˆ View ìƒì„± ì‹¤íŒ¨                                            â”‚
â”‚  - í¬ë˜ì‹œ ë˜ëŠ” ë Œë”ë§ ì˜¤ë¥˜                                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í•´ê²°: Texture_DX12ë¥¼ Resource_DX12ì— ë³‘í•©

### ë³‘í•©ëœ Resource_DX12

```cpp
struct Resource_DX12
{
    ComPtr<ID3D12Resource> resource;
    D3D12MA::Allocation* allocation = nullptr;
    uint64_t gpu_address = 0;

    // SRV/UAV (ê¸°ì¡´)
    SingleDescriptor srv = {};
    SingleDescriptor uav = {};
    std::vector<SingleDescriptor> subresources_srv;
    std::vector<SingleDescriptor> subresources_uav;

    // âœ… RTV/DSV (Texture_DX12ì—ì„œ ì´ë™)
    SingleDescriptor rtv = {};
    SingleDescriptor dsv = {};
    std::vector<SingleDescriptor> subresources_rtv;
    std::vector<SingleDescriptor> subresources_dsv;

    // âœ… mapped_subresourcesë„ ì´ë™
    std::vector<SubresourceData> mapped_subresources;

    void destroy_subresources()
    {
        srv.destroy();
        uav.destroy();
        rtv.destroy();  // âœ… ì´ì œ ì •ë¦¬ë¨!
        dsv.destroy();  // âœ… ì´ì œ ì •ë¦¬ë¨!

        for (auto& x : subresources_srv) x.destroy();
        for (auto& x : subresources_uav) x.destroy();
        for (auto& x : subresources_rtv) x.destroy();  // âœ…
        for (auto& x : subresources_dsv) x.destroy();  // âœ…

        subresources_srv.clear();
        subresources_uav.clear();
        subresources_rtv.clear();
        subresources_dsv.clear();
    }

    ~Resource_DX12()
    {
        destroy_subresources();
        // allocation í•´ì œ ë“±...
    }
};

// Texture_DX12 í´ë˜ìŠ¤ ì‚­ì œ!
```

### ê´€ë ¨ ë³€ê²½

```cpp
// to_internal ë°˜í™˜ íƒ€ì… ë³€ê²½
Resource_DX12* to_internal(const Texture* param)
{
    return static_cast<Resource_DX12*>(param->internal_state.get());
}

// SwapChain_DX12 íƒ€ì… ë³€ê²½
struct SwapChain_DX12
{
    // ë³€ê²½ ì „
    std::vector<shared_ptr<Texture_DX12>> textures;

    // ë³€ê²½ í›„
    std::vector<shared_ptr<Resource_DX12>> textures;
};

// make_shared íƒ€ì… ë³€ê²½
// ë³€ê²½ ì „
auto internal = make_shared<Texture_DX12>();

// ë³€ê²½ í›„
auto internal = make_shared<Resource_DX12>();
```

---

## ë‹¤ì´ì–´ê·¸ë¨: êµ¬ì¡° ë³€ê²½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ë³€ê²½ ì „                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Resource_DX12 (base)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ resource, allocation, gpu_address                      â”‚     â”‚
â”‚  â”‚ srv, uav, subresources_srv, subresources_uav           â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚ destroy_subresources() â†’ SRV, UAVë§Œ ì •ë¦¬              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                    â–³                                            â”‚
â”‚                    â”‚ ìƒì†                                       â”‚
â”‚                    â”‚                                            â”‚
â”‚  Texture_DX12 final                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ rtv, dsv, subresources_rtv, subresources_dsv           â”‚     â”‚
â”‚  â”‚ mapped_subresources                                    â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚ (destroy_subresources ì˜¤ë²„ë¼ì´ë“œ ì—†ìŒ â†’ RTV/DSV ëˆ„ìˆ˜!) â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ë³€ê²½ í›„                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Resource_DX12 (í†µí•©)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ resource, allocation, gpu_address                      â”‚     â”‚
â”‚  â”‚ srv, uav, subresources_srv, subresources_uav           â”‚     â”‚
â”‚  â”‚ rtv, dsv, subresources_rtv, subresources_dsv  â† ë³‘í•©!  â”‚     â”‚
â”‚  â”‚ mapped_subresources                           â† ë³‘í•©!  â”‚     â”‚
â”‚  â”‚                                                        â”‚     â”‚
â”‚  â”‚ destroy_subresources() â†’ ëª¨ë‘ ì •ë¦¬ âœ…                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  Texture_DX12 í´ë˜ìŠ¤ ì‚­ì œ! âœ…                                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì™œ ìƒì† ëŒ€ì‹  ë³‘í•©?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ìƒì† vs ë³‘í•© ì„ íƒ ì´ìœ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ëŒ€ì•ˆ 1: destroy_subresources() ì˜¤ë²„ë¼ì´ë“œ                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  struct Texture_DX12 : Resource_DX12 {                          â”‚
â”‚      void destroy_subresources() override {                     â”‚
â”‚          Resource_DX12::destroy_subresources();                 â”‚
â”‚          rtv.destroy();                                         â”‚
â”‚          dsv.destroy();                                         â”‚
â”‚          // ...                                                 â”‚
â”‚      }                                                          â”‚
â”‚  };                                                             â”‚
â”‚                                                                 â”‚
â”‚  ë¬¸ì œ: virtual í•¨ìˆ˜ í•„ìš” â†’ vtable ì˜¤ë²„í—¤ë“œ (ì»¤ë°‹ #7 ì² í•™ ìœ„ë°˜)  â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚  ëŒ€ì•ˆ 2: í´ë˜ìŠ¤ ë³‘í•© (ì„ íƒë¨)                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚  - Texture_DX12ì˜ ë©¤ë²„ë¥¼ Resource_DX12ë¡œ ì´ë™                   â”‚
â”‚  - Texture_DX12 í´ë˜ìŠ¤ ì‚­ì œ                                     â”‚
â”‚  - ë²„í¼ì—ë„ rtv/dsv ë©¤ë²„ê°€ ìƒê¸°ì§€ë§Œ ì‚¬ìš© ì•ˆ í•¨ (ì•½ê°„ì˜ ë©”ëª¨ë¦¬)  â”‚
â”‚                                                                 â”‚
â”‚  ì¥ì :                                                          â”‚
â”‚  - vtable ì˜¤ë²„í—¤ë“œ ì—†ìŒ                                         â”‚
â”‚  - ì½”ë“œ ë‹¨ìˆœí™”                                                  â”‚
â”‚  - destroy_subresources()ê°€ ëª¨ë“  descriptor ì •ë¦¬                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## VizMotive ì ìš© í˜„í™©

### ì ìš© ì™„ë£Œ âœ…

**ì ìš© ì¼ì**: 2026-01-29

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| GraphicsDevice_DX12.cpp | `Texture_DX12` ë©¤ë²„ë“¤ì„ `Resource_DX12`ë¡œ ì´ë™ |
| GraphicsDevice_DX12.cpp | `destroy_subresources()`ì—ì„œ RTV/DSV ì •ë¦¬ ì¶”ê°€ |
| GraphicsDevice_DX12.cpp | `Texture_DX12` í´ë˜ìŠ¤ ì‚­ì œ |
| GraphicsDevice_DX12.cpp | ëª¨ë“  `Texture_DX12` ì°¸ì¡°ë¥¼ `Resource_DX12`ë¡œ ë³€ê²½ |
| GraphicsDevice_DX12.cpp | `to_internal(const Texture*)` ë°˜í™˜ íƒ€ì… ë³€ê²½ |
| GraphicsDevice_DX12.cpp | `SwapChain_DX12::textures` íƒ€ì… ë³€ê²½ |

### ì½”ë“œ ìœ„ì¹˜

```cpp
// Resource_DX12 - í†µí•©ëœ êµ¬ì¡°ì²´
struct Resource_DX12
{
    // ... ê¸°ì¡´ ë©¤ë²„ ...

    // Texture ì „ìš© ë©¤ë²„ (ë³‘í•©ë¨)
    SingleDescriptor rtv = {};
    SingleDescriptor dsv = {};
    std::vector<SingleDescriptor> subresources_rtv;
    std::vector<SingleDescriptor> subresources_dsv;
    std::vector<SubresourceData> mapped_subresources;

    void destroy_subresources()
    {
        srv.destroy();
        uav.destroy();
        rtv.destroy();
        dsv.destroy();
        for (auto& x : subresources_srv) x.destroy();
        for (auto& x : subresources_uav) x.destroy();
        for (auto& x : subresources_rtv) x.destroy();
        for (auto& x : subresources_dsv) x.destroy();
        // ...
    }
};
```

---

## ìš”ì•½

| í•­ëª© | ë‚´ìš© |
|------|------|
| ë¬¸ì œ | `DeleteSubresources()`ê°€ RTV/DSV descriptorë¥¼ ì •ë¦¬ ì•ˆ í•¨ |
| ì›ì¸ | RTV/DSVê°€ `Texture_DX12`ì— ìˆì–´ì„œ `Resource_DX12::destroy_subresources()`ê°€ ì ‘ê·¼ ëª» í•¨ |
| í•´ê²° | `Texture_DX12`ë¥¼ `Resource_DX12`ì— ë³‘í•© |
| íš¨ê³¼ | ëª¨ë“  descriptorê°€ ì˜¬ë°”ë¥´ê²Œ ì •ë¦¬ë¨, Descriptor leak ë°©ì§€ |
| VizMotive | âœ… ì ìš© ì™„ë£Œ |

### í•µì‹¬ êµí›ˆ

> **ìƒì† êµ¬ì¡°ì—ì„œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬ ì£¼ì˜**
>
> ë² ì´ìŠ¤ í´ë˜ìŠ¤ì˜ ì •ë¦¬ í•¨ìˆ˜ê°€ íŒŒìƒ í´ë˜ìŠ¤ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì•Œì§€ ëª»í•¨.
> - í•´ê²° 1: virtual í•¨ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ (vtable ì˜¤ë²„í—¤ë“œ)
> - í•´ê²° 2: í´ë˜ìŠ¤ ë³‘í•© (êµ¬ì¡° ë‹¨ìˆœí™”)
>
> vtable ì˜¤ë²„í—¤ë“œë¥¼ í”¼í•˜ë©´ì„œ ì˜¬ë°”ë¥¸ ì •ë¦¬ë¥¼ ìœ„í•´ ë³‘í•© ì„ íƒ.

> **DescriptorëŠ” ë°˜ë“œì‹œ í•´ì œí•´ì•¼ í•¨**
>
> DX12 descriptor heapì€ ì œí•œëœ í¬ê¸°.
> Descriptor leakì€ ì¥ê¸° ì‹¤í–‰ ì‹œ heap ê³ ê°ˆë¡œ ì´ì–´ì§.
> ëª¨ë“  View(SRV, UAV, RTV, DSV)ì˜ ìˆ˜ëª…ì„ ì¶”ì í•˜ê³  í•´ì œ í•„ìš”.
